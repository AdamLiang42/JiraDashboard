
@model JiraDashboard.Models.JiraDBContext
@{
    ViewData["Title"] = "Jira";
}

<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.2.2/Chart.bundle.min.js"></script>
    <script type="text/javascript">

        var barChartData = {
              labels: @Json.Serialize(Model.GraphLabel),
              datasets: [
                {
                  label: "Last 4 weeks",
                  backgroundColor: "#5B9BD5",
                  borderWidth: 1,
                  data: @Json.Serialize(Model.GraphMonthlyTask)
                },
                {
                  label: "Last 12 Months",
                  backgroundColor: "#A5A5A5",
                  borderWidth: 1,
                  data: @Json.Serialize(Model.GraphYTDTask)
                }
              ]
            };

            window.onload = function () {
                var ctx1 = document.getElementById("barcanvas").getContext("2d");
                window.myBar = new Chart(ctx1,
                    {
                        type: 'bar',
                        data: barChartData,
                        options:
                            {
                                title:
                                {
                                    display: true,
                                    text: "Tasks Completed for Projects Last 4 Weeks (Projects with more than 10 new tasks added excluding CLSD)"
                                },
                                responsive: true,
                                maintainAspectRatio: true
                            }
                    });
            }
    </script>
    <style>
           summary::-webkit-details-marker 
           {
                display: none;
           }
    </style>
</head>

<div style="float: left; width:100%; margin-left:10px">
    <h2>Project Tasks (Completed and Current Backlog)</h2>
    <div style="text-align: center; width:100%">
        <canvas id="barcanvas"></canvas>
    </div>
    <table class="table-bordered">
        <tr>
            <th rowspan="2" style="vertical-align:middle;text-align:center;background-color:#DDEBF7; width:250px">Project</th>
            <th colspan="2" style="vertical-align:middle;text-align:center;background-color:#9BC2E6">Last 4 Weeks</th>
            <th colspan="3" style="vertical-align:middle;text-align:center;background-color:#ACB9CA">Last 12 Months</th>
        </tr>
        <tr>
            <th style="background-color:#DDEBF7; width:80px">New Tasks Created</th>
            <th style="background-color:#DDEBF7">Completed</th>
            <th style="background-color:#D6DCE4">Tasks Created</th>
            <th style="background-color:#D6DCE4">Completed</th>
            <th style="background-color:#D6DCE4">Backlog</th>
        </tr>
        @foreach (var item in Model.TasksCreatedAndCompletedThisPeriodAndYTD)
    {
        <tr>
            <td style="width:250px">@Html.DisplayTextFor(modelItem => item.Project)</td>
            <td>@Html.DisplayTextFor(modelItem => item.TasksCreatedThisMonth)</td>
            <td>@Html.DisplayTextFor(modelItem => item.Completed)</td>
            <td>@Html.DisplayTextFor(modelItem => item.TasksCreatedYTD)</td>
            <td>@Html.DisplayTextFor(modelItem => item.TasksCompletedYTD)</td>
            <td>@Html.DisplayTextFor(modelItem => item.Backlog)</td>
        </tr>
    }
        <tr style="background-color:#DDEBF7;width:250px">
            <th>@Html.DisplayTextFor(modelItem => Model.TotalCountProjectTasks.Project)</th>
            <th>@Html.DisplayTextFor(modelItem => Model.TotalCountProjectTasks.TasksCreatedThisMonth)</th>
            <th>@Html.DisplayTextFor(modelItem => Model.TotalCountProjectTasks.Completed)</th>
            <th>@Html.DisplayTextFor(modelItem => Model.TotalCountProjectTasks.TasksCreatedYTD)</th>
            <th>@Html.DisplayTextFor(modelItem => Model.TotalCountProjectTasks.TasksCompletedYTD)</th>
            <th>@Html.DisplayTextFor(modelItem => Model.TotalCountProjectTasks.Backlog)</th>
        </tr>
    </table>
</div>


